/*
 * Slideshow
 * Copyright(c) 2011, Matthias Lensing - enobis GmbH.
 */


function Slider(DivID,ImagePath){var Instance=this;this.Div=document.getElementById(DivID);this.DivNavigation=null;this.Current=0;this.Slides=new Array();this.SlidesNav=new Array();this.SlidesCount=0;this.Status='stop';this.Delay=5000;this.Timer=null;this.ImagePath=ImagePath;function NavigationButton(SliderInstance,ItemIndex,Link,LinkTarget){var Instance=this;this.SliderInstance=SliderInstance;this.Index=parseInt(ItemIndex);this.IMG=document.createElement('img');this.IMG_ON=document.createElement('img');this.IMG_LINK=Link;this.IMG_LINK_TARGET=LinkTarget;this.Active=function(){this.IMG.style.display='none';this.IMG_ON.style.display='';};this.Deactive=function(){this.IMG_ON.style.display='none';this.IMG.style.display='';};this.ButtonOver=function(){Instance.SliderInstance.stop();Instance.SliderInstance.slideTo(Instance.Index);};this.ButtonOut=function(){Instance.SliderInstance.start();};this.ButtonClick=function(){Instance.SliderInstance.stop();if(Instance.IMG_LINK_TARGET=='_blank'){window.open(Instance.IMG_LINK);}else{window.location.href=Instance.IMG_LINK;};};this.RenderTo=function(ParentDiv){this.IMG_ON.src=SliderInstance.ImagePath+(this.Index+1)+'_on.gif';this.IMG_ON.style.display='none';this.IMG_ON.onmouseout=this.ButtonOut;this.IMG.src=SliderInstance.ImagePath+(this.Index+1)+'.gif';this.IMG.onmouseover=this.ButtonOver;if(this.IMG_LINK&&this.IMG_LINK!=''){this.IMG_ON.onclick=this.ButtonClick;this.IMG.onclick=this.ButtonClick;}
ParentDiv.appendChild(this.IMG);ParentDiv.appendChild(this.IMG_ON);};};this.stop=function(){if(this.Status!='stop'){window.clearInterval(this.Timer);this.Status='stop';};};this.start=function(){if(this.Status!='start'){this.Timer=window.setInterval(function(){Instance.next()},this.Delay);this.Status='start';};};this.next=function(){var tmpPosition=Instance.Current+1;if(tmpPosition>=Instance.SlidesCount)tmpPosition=0;Instance.slideTo(tmpPosition);}
this.slideTo=function(Position){if(Position!=this.Current){var newSlide=this.Slides[Position];var newSlideNav=this.SlidesNav[Position];var oldSlide=this.Slides[this.Current];var oldSlideNav=this.SlidesNav[this.Current];if(newSlide){if(oldSlideNav)oldSlideNav.Deactive();if(newSlideNav)newSlideNav.Active();newSlide.className='item current';if(oldSlide)oldSlide.className='item';this.Current=Position;};};};this.NavigationCreate=function(){this.DivNavigation=document.createElement('div');this.DivNavigation.className='navigation';for(var i=0;i<this.SlidesCount;i++){var tmpNavLink='';var tmpNavLinkTarget='_self';try{var FirstLink=this.Slides[i].getElementsByTagName('a')[0].href;tmpNavLinkTarget=this.Slides[i].getElementsByTagName('a')[0].target
var test=typeof(FirstLink);if(typeof(FirstLink)=='string'){tmpNavLink=FirstLink;};}catch(ex){};var tmpNavButton=new NavigationButton(this,i,tmpNavLink,tmpNavLinkTarget);this.SlidesNav[i]=tmpNavButton;tmpNavButton.RenderTo(this.DivNavigation);if(i==0)tmpNavButton.Active();};this.Div.insertBefore(this.DivNavigation,this.Div.firstChild);};this.getSlideDivs=function(){for(var i=0;i<this.Div.childNodes.length;i++){try{var objItem=this.Div.childNodes[i];if(objItem.className.toLowerCase().indexOf('item')>=0){this.Slides[this.SlidesCount++]=objItem;};}catch(ex){};}};this.init=function(){if(!this.Div)return false;this.getSlideDivs();if(this.SlidesCount<=1)return false;this.NavigationCreate();};this.init();}